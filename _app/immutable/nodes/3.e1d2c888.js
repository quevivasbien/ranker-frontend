import{u as A,a as D}from"../chunks/stores.da387759.js";import{i as J,f as R,h as j,j as W,k as S,s as G,n as d,r as K}from"../chunks/scheduler.d3ab1ae5.js";import{p as O,t as w,b as T,d as b,S as Q,i as X,g,s as P,e as F,h as v,A as z,c as $,k,a as C,f as p,m as Y,j as I,n as Z,y,z as U,B as ee,C as te,D as le,E as q,r as ne,u as oe,v as re,w as se}from"../chunks/index.543365ac.js";import{e as x}from"../chunks/each.e59479a4.js";import{I as ae}from"../chunks/ItemInfo.e223d29d.js";function N(n,e){const r=e.token={};function t(l,i,a,s){if(e.token!==r)return;e.resolved=s;let o=e.ctx;a!==void 0&&(o=o.slice(),o[a]=s);const c=l&&(e.current=l)(o);let u=!1;e.block&&(e.blocks?e.blocks.forEach((m,h)=>{h!==i&&m&&(O(),w(m,1,1,()=>{e.blocks[h]===m&&(e.blocks[h]=null)}),T())}):e.block.d(1),c.c(),b(c,1),c.m(e.mount(),e.anchor),u=!0),e.block=c,e.blocks&&(e.blocks[i]=c),u&&W()}if(J(n)){const l=R();if(n.then(i=>{j(l),t(e.then,1,e.value,i),j(null)},i=>{if(j(l),t(e.catch,2,e.error,i),j(null),!e.hasCatch)throw i}),e.current!==e.pending)return t(e.pending,0),!0}else{if(e.current!==e.then)return t(e.then,1,e.value,n),!0;e.resolved=n}}function H(n,e,r){const t=e.slice(),{resolved:l}=n;n.current===n.then&&(t[n.value]=l),n.current===n.catch&&(t[n.error]=l),n.block.p(t,r)}function ce(n){return{getItemsForComparison:async()=>{const l=S(A);if(!l)return console.log("No user info when fetching items for comparison"),null;const i=await n.fetch("https://ranker-backend.fly.dev/compare",{headers:{Authorization:l.token}});return i.ok?await i.json():(console.log("Error fetching items for comparison, received response",i),null)},getItem:async l=>{const i=S(D);let a=i.find(c=>c.name===l);if(a)return a;const s=S(A);if(s==null)return console.log("No user info when fetching item info for comparison"),null;const o=await n.fetch(`https://ranker-backend.fly.dev/items/${l}`,{headers:{Authorization:s.token}});return o.ok?(a=await o.json(),i.push(a),D.set(i),a):(console.log("Error fetching item, received response",o),null)},sendUserChoice:async(l,i,a)=>{const s=S(A);return s?(await n.fetch("https://ranker-backend.fly.dev/compare",{method:"POST",headers:{"Content-Type":"application/json",Authorization:s.token},body:JSON.stringify({item1:l,item2:i,winner:a})})).status:(console.log("No user info when sending user choice"),500)}}}const Ie=Object.freeze(Object.defineProperty({__proto__:null,load:ce},Symbol.toStringTag,{value:"Module"}));function V(n,e,r){const t=n.slice();return t[12]=e[r],t}function ie(n){return{c:d,l:d,m:d,p:d,i:d,o:d,d}}function ue(n){let e,r,t,l,i,a,s,o,c,u=n[11]&&L(n);function m(){return n[7](n[11])}function h(){return n[8](n[11])}return{c(){e=g("form"),u&&u.c(),r=P(),t=g("div"),l=g("button"),i=Y("Submit"),this.h()},l(_){e=v(_,"FORM",{class:!0});var f=I(e);u&&u.l(f),r=$(f),t=v(f,"DIV",{class:!0});var E=I(t);l=v(E,"BUTTON",{type:!0,class:!0});var B=I(l);i=Z(B,"Submit"),B.forEach(p),E.forEach(p),f.forEach(p),this.h()},h(){k(l,"type","button"),k(l,"class","drop-shadow rounded bg-blue-200 disabled:bg-gray-300 p-2"),l.disabled=a=n[1]===void 0,k(t,"class","flex flex-row justify-end"),k(e,"class","flex flex-col space-y-2")},m(_,f){C(_,e,f),u&&u.m(e,null),y(e,r),y(e,t),y(t,l),y(l,i),s=!0,o||(c=[U(l,"click",m),U(e,"submit",ee(h))],o=!0)},p(_,f){n=_,n[11]?u?(u.p(n,f),f&1&&b(u,1)):(u=L(n),u.c(),b(u,1),u.m(e,r)):u&&(O(),w(u,1,1,()=>{u=null}),T()),(!s||f&2&&a!==(a=n[1]===void 0))&&(l.disabled=a)},i(_){s||(b(u),s=!0)},o(_){w(u),s=!1},d(_){_&&p(e),u&&u.d(),o=!1,K(c)}}}function L(n){let e,r,t=x(n[11]),l=[];for(let a=0;a<t.length;a+=1)l[a]=M(V(n,t,a));const i=a=>w(l[a],1,1,()=>{l[a]=null});return{c(){e=g("div");for(let a=0;a<l.length;a+=1)l[a].c();this.h()},l(a){e=v(a,"DIV",{class:!0});var s=I(e);for(let o=0;o<l.length;o+=1)l[o].l(s);s.forEach(p),this.h()},h(){k(e,"class","flex flex-row space-x-4")},m(a,s){C(a,e,s);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null);r=!0},p(a,s){if(s&7){t=x(a[11]);let o;for(o=0;o<t.length;o+=1){const c=V(a,t,o);l[o]?(l[o].p(c,s),b(l[o],1)):(l[o]=M(c),l[o].c(),b(l[o],1),l[o].m(e,null))}for(O(),o=t.length;o<l.length;o+=1)i(o);T()}},i(a){if(!r){for(let s=0;s<t.length;s+=1)b(l[s]);r=!0}},o(a){l=l.filter(Boolean);for(let s=0;s<l.length;s+=1)w(l[s]);r=!1},d(a){a&&p(e),te(l,a)}}}function fe(n){return{c:d,l:d,m:d,p:d,i:d,o:d,d}}function he(n){let e,r,t,l,i;const a=[_e,de],s=[];function o(c,u){return c[15]!==null?0:1}return r=o(n),t=s[r]=a[r](n),{c(){e=g("div"),t.c(),this.h()},l(c){e=v(c,"DIV",{class:!0});var u=I(e);t.l(u),u.forEach(p),this.h()},h(){k(e,"class",l=`border rounded-md m-1 p-4 w-full ${n[1]===n[12]?"bg-white drop-shadow-md border-2":"bg-inherit"}`)},m(c,u){C(c,e,u),s[r].m(e,null),i=!0},p(c,u){let m=r;r=o(c),r===m?s[r].p(c,u):(O(),w(s[m],1,1,()=>{s[m]=null}),T(),t=s[r],t?t.p(c,u):(t=s[r]=a[r](c),t.c()),b(t,1),t.m(e,null)),(!i||u&3&&l!==(l=`border rounded-md m-1 p-4 w-full ${c[1]===c[12]?"bg-white drop-shadow-md border-2":"bg-inherit"}`))&&k(e,"class",l)},i(c){i||(b(t),i=!0)},o(c){w(t),i=!1},d(c){c&&p(e),s[r].d()}}}function de(n){let e,r="Item not found";return{c(){e=g("p"),e.textContent=r},l(t){e=v(t,"P",{["data-svelte-h"]:!0}),z(e)!=="svelte-9i07uy"&&(e.textContent=r)},m(t,l){C(t,e,l)},p:d,i:d,o:d,d(t){t&&p(e)}}}function _e(n){let e,r;return e=new ae({props:{item:n[15]}}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,l){re(e,t,l),r=!0},p(t,l){const i={};l&1&&(i.item=t[15]),e.$set(i)},i(t){r||(b(e.$$.fragment,t),r=!0)},o(t){w(e.$$.fragment,t),r=!1},d(t){se(e,t)}}}function pe(n){let e,r="loading...";return{c(){e=g("p"),e.textContent=r},l(t){e=v(t,"P",{["data-svelte-h"]:!0}),z(e)!=="svelte-qeejp2"&&(e.textContent=r)},m(t,l){C(t,e,l)},p:d,i:d,o:d,d(t){t&&p(e)}}}function M(n){let e,r,t,l=!1,i,a,s,o,c,u,m,h={ctx:n,current:null,token:null,hasCatch:!1,pending:pe,then:he,catch:fe,value:15,blocks:[,,,]};return N(a=n[2](n[12]),h),c=le(n[6][0]),{c(){e=g("label"),r=g("input"),i=P(),h.block.c(),s=P(),this.h()},l(_){e=v(_,"LABEL",{class:!0});var f=I(e);r=v(f,"INPUT",{type:!0,class:!0}),i=$(f),h.block.l(f),s=$(f),f.forEach(p),this.h()},h(){k(r,"type","radio"),r.__value=t=n[12],q(r,r.__value),k(r,"class","appearance-none"),k(e,"class","flex flex-row cursor-pointer min-w-[25%]"),c.p(r)},m(_,f){C(_,e,f),y(e,r),r.checked=r.__value===n[1],y(e,i),h.block.m(e,h.anchor=null),h.mount=()=>e,h.anchor=s,y(e,s),o=!0,u||(m=U(r,"change",n[5]),u=!0)},p(_,f){n=_,(!o||f&1&&t!==(t=n[12]))&&(r.__value=t,q(r,r.__value),l=!0),(l||f&3)&&(r.checked=r.__value===n[1]),h.ctx=n,f&1&&a!==(a=n[2](n[12]))&&N(a,h)||H(h,n,f)},i(_){o||(b(h.block),o=!0)},o(_){for(let f=0;f<3;f+=1){const E=h.blocks[f];w(E)}o=!1},d(_){_&&p(e),h.block.d(),h.token=null,h=null,c.r(),u=!1,m()}}}function me(n){let e,r="loading...";return{c(){e=g("p"),e.textContent=r},l(t){e=v(t,"P",{["data-svelte-h"]:!0}),z(e)!=="svelte-qeejp2"&&(e.textContent=r)},m(t,l){C(t,e,l)},p:d,i:d,o:d,d(t){t&&p(e)}}}function be(n){let e,r="Which do you prefer?",t,l,i,a,s={ctx:n,current:null,token:null,hasCatch:!1,pending:me,then:ue,catch:ie,value:11,blocks:[,,,]};return N(i=n[0],s),{c(){e=g("h1"),e.textContent=r,t=P(),l=F(),s.block.c(),this.h()},l(o){e=v(o,"H1",{class:!0,["data-svelte-h"]:!0}),z(e)!=="svelte-vxr97"&&(e.textContent=r),t=$(o),l=F(),s.block.l(o),this.h()},h(){k(e,"class","text-2xl mb-8")},m(o,c){C(o,e,c),C(o,t,c),C(o,l,c),s.block.m(o,s.anchor=c),s.mount=()=>l.parentNode,s.anchor=l,a=!0},p(o,[c]){n=o,s.ctx=n,c&1&&i!==(i=n[0])&&N(i,s)||H(s,n,c)},i(o){a||(b(s.block),a=!0)},o(o){for(let c=0;c<3;c+=1){const u=s.blocks[c];w(u)}a=!1},d(o){o&&(p(e),p(t),p(l)),s.block.d(o),s.token=null,s=null}}}function ke(n,e,r){let{data:t}=e;const{getItemsForComparison:l,getItem:i,sendUserChoice:a}=t;let s=l(),o;function c(f){o===void 0||f===null||(a(f[0],f[1],o).then(()=>{r(0,s=l())}),r(1,o=void 0))}const u=[[]];function m(){o=this.__value,r(1,o)}const h=f=>c(f),_=f=>c(f);return n.$$set=f=>{"data"in f&&r(4,t=f.data)},[s,o,i,c,t,m,u,h,_]}class Ee extends Q{constructor(e){super(),X(this,e,ke,be,G,{data:4})}}export{Ee as component,Ie as universal};
